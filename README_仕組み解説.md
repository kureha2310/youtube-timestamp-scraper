# YouTube歌配信タイムスタンプ管理システム - 仕組み解説（未経験者向け）

> 「プログラミングは全く分からないけど、どうやって動いてるのか知りたい！」という方向けの解説です

---

## 🤔 そもそも何をしているの？

### やりたいこと
推しのVTuberが歌配信で歌った曲を、後から探しやすくしたい

### 問題点
```
配信アーカイブを見る
  ↓
「あの曲どこで歌ってたっけ？」
  ↓
2時間の動画をシークバーで探す...😫
  ↓
コメント欄にタイムスタンプあるけどバラバラ...
  ↓
諦める
```

### このシステムがやること
```
1. YouTubeから自動で情報を集める
2. タイムスタンプを整理する
3. クリック1つで該当箇所に飛べるリストを作る
```

---

## 📚 全体の流れ（超かんたん版）

```
ステップ1: YouTubeから情報を集める（Python）
  "この人の動画、全部チェックするね"
  ↓
ステップ2: 整理してファイルに保存（Python）
  "歌配信だけ選んで、タイムスタンプをまとめたよ"
  ↓
ステップ3: Googleスプレッドシートにコピペ（手作業）
  "ここに貼り付けてね"
  ↓
ステップ4: 見やすく整理（Google Apps Script）
  "ジャンル別に分けて、リンク付けたよ！"
```

---

## 🔍 詳しい仕組み（5つの重要ポイント）

### ポイント1: YouTubeから情報を取る仕組み

**Q: どうやってYouTubeから情報を取ってくるの？**

A: YouTubeには「YouTube Data API」という**情報を取り出すための窓口**があります

**例え話:**
```
図書館の司書さんに本を頼むイメージ

あなた: "この著者の本、全部見せて"
司書さん: "はい、全部で100冊ありますよ"

あなた: "この本のコメント欄見せて"
司書さん: "はい、50件のコメントがありますよ"
```

**実際の動き:**
```
プログラム: "チャンネルID: UCxxxxxx の動画リストください"
YouTube API: "はい、115件の動画があります"

プログラム: "動画ID: abc123 のコメントください"
YouTube API: "はい、50件のコメントがあります"
```

**重要な制限:**
- 1日に10,000回まで質問できる（無料）
- それ以上は翌日まで待つか、お金を払う必要がある

---

### ポイント2: 歌配信かどうかを判定する仕組み

**Q: どうやって「これは歌配信だ」と判断するの？**

A: **点数制**で判定します。色々な手がかりを見て、合計点が高ければ「歌配信」と判断

**判定のチェックリスト:**
```
✅ タイトルに「歌」という文字がある → +3点
✅ タイトルに音符の絵文字(🎵🎤)がある → +2点
✅ 説明文に「セトリ」という文字がある → +1点
✅ コメント欄にたくさんタイムスタンプがある → +4点
❌ タイトルに「ゲーム」という文字がある → -1点
❌ タイトルに「雑談」という文字がある → -1点
```

**実際の例:**
```
例1: 【#歌枠】今日も歌うよ～！
  ✓ 「歌」がある (+3)
  ✓ コメントにTS50個 (+4)
  → 合計7点 → 歌配信！

例2: 【ゲーム】APEX配信
  ✗ 「ゲーム」がある (-1)
  → 合計-1点 → 歌配信じゃない

例3: まったり配信（タイトルに「歌」なし）
  ✓ でもコメント欄に「6:53 曲名」がたくさん (+4)
  → 合計4点 → 歌配信！
```

**これが重要な理由:**
- タイトルに「歌枠」って書いてなくても見逃さない
- ゲーム配信なのにBGMのタイムスタンプがあるだけ、は除外できる

---

### ポイント3: タイムスタンプを見つける仕組み

**Q: コメント欄からどうやってタイムスタンプを探すの？**

A: **パターン認識**を使います。「こういう形のテキスト = タイムスタンプ」というルールを設定

**探すパターン:**
```
パターン1: "6:53 サイハテ/小林オニキス"
           ↑↑↑  ↑↑↑↑↑↑↑↑↑↑↑↑↑
           時間  曲名とアーティスト

パターン2: "01. アイデンティティ / Kanaria"
           ↑↑  ↑↑↑↑↑↑↑↑↑↑↑  ↑↑↑↑↑
          番号   曲名              アーティスト
```

**実際の処理:**
```
手順1: コメントを1行ずつ読む
  "素敵な配信でした！"        → タイムスタンプなし、スキップ
  "6:53 サイハテ/小林オニキス" → あった！保存

手順2: 時間部分と曲情報に分ける
  "6:53" → タイムスタンプ
  "サイハテ/小林オニキス" → 曲情報

手順3: 曲名とアーティストに分ける
  "/" で分割
  "サイハテ" → 曲名
  "小林オニキス" → アーティスト
```

**余計な文字を削除:**
```
Before: "01. ＆ サイハテ / 小林オニキス feat. 初音ミク"
         ↓
手順1: "01." を削除
  → "＆ サイハテ / 小林オニキス feat. 初音ミク"
         ↓
手順2: "＆" を削除
  → "サイハテ / 小林オニキス feat. 初音ミク"
         ↓
手順3: "/" で分割
  → 曲名: "サイハテ"
  → アーティスト: "小林オニキス feat. 初音ミク"
```

---

### ポイント4: 重複をまとめる仕組み

**Q: 同じ曲のタイムスタンプが複数あったらどうするの？**

A: **自動で一番良いものを選びます**

**重複が起きる例:**
```
Aさん: "6:53 サイハテ"
Bさん: "6:55 サイハテ"              ← 2秒ずれてる
Cさん: "6:53 サイハテ/小林オニキス" ← アーティスト名もある
```

**まとめ方のルール:**
```
ルール1: ±5秒以内は「同じ曲」とみなす
  6:53, 6:55, 6:57 → 全部同じ曲

ルール2: 一番詳しい情報を残す
  優先順位:
  1位: "サイハテ/小林オニキス" ← アーティスト名がある
  2位: "サイハテ"             ← 曲名だけ
  3位: "01. サイハテ"         ← 番号がついてる（余計）

  → "サイハテ/小林オニキス" を採用！
```

**なぜ必要？**
- 視聴者が複数タイムスタンプを書くことがよくある
- リストに同じ曲が何個も出ると見づらい
- 情報が一番詳しいものだけあれば十分

**具体例:**
```
Before（重複あり）:
  6:53  サイハテ
  6:55  サイハテ
  6:53  サイハテ/小林オニキス feat. 初音ミク
  14:19 アイデンティティ
  14:19 アイデンティティ/Kanaria

After（まとめた後）:
  6:53  サイハテ/小林オニキス feat. 初音ミク
  14:19 アイデンティティ/Kanaria
```

---

### ポイント5: Googleスプレッドシートで見やすくする仕組み

**Q: スプレッドシートでなぜジャンル別シートができるの？**

A: Google Apps Scriptという**スプレッドシート専用のプログラム**が自動で整理します

**処理の流れ:**

#### ステップ1: ジャンルで分ける
```
元のリスト:
  メルト        / ryo(supercell)   / Vocaloid
  シルエット    / KANA-BOON        / アニメ
  マリーゴールド / あいみょん        / その他
  ローリンガール / wowaka           / Vocaloid

↓ ジャンル列を見て分類

Vocaloidシート:
  メルト
  ローリンガール

アニメシート:
  シルエット

その他シート:
  マリーゴールド
```

#### ステップ2: 同じ曲をまとめる
```
元データ（1曲1行）:
  メルト / ryo / 2025/02/04 / 1:14:49
  メルト / ryo / 2025/03/17 / 2:15:30
  メルト / ryo / 2025/05/10 / 3:45:12

↓ 同じ曲を1行にまとめる

変換後（1曲1行、歌った回数ごとに列を追加）:
┌────┬──────┬──────┬──────────┬─────────┬──────────┬─────────┐
│回数│曲名   │アーティ│配信日1   │TS1      │配信日2   │TS2      │...
├────┼──────┼────ス─┼──────────┼─────────┼──────────┼─────────┤
│ 3  │メルト │ryo    │2025/02/04│1:14:49  │2025/03/17│2:15:30  │...
└────┴──────┴──────┴──────────┴─────────┴──────────┴─────────┘
```

#### ステップ3: リンクを作る
```
元データ:
  タイムスタンプ: "1:14:49"
  動画ID: "abc123xyz"

↓ 計算

1:14:49 = 1×3600 + 14×60 + 49 = 4489秒

↓ YouTubeのURL形式に変換

https://www.youtube.com/watch?v=abc123xyz&t=4489s
                                          ↑↑↑↑
                                        秒数を指定

↓ スプレッドシートのリンク形式に

=HYPERLINK("https://...", "1:14:49")
           ↑↑↑↑↑↑↑↑↑↑↑↑   ↑↑↑↑↑↑↑
           リンク先URL        表示する文字

↓ 結果

クリックすると動画が1:14:49から再生される！
```

---

## 🎨 なぜこの方法なの？（設計の理由）

### Q1: なぜPythonとGoogle Apps Scriptの2段階？

**A: それぞれ得意なことが違うから**

```
Python（プログラミング言語）が得意なこと:
  ✓ 大量のデータを処理
  ✓ 複雑な判定ロジック
  ✓ APIとの通信
  ✗ スプレッドシートの見た目調整は苦手

Google Apps Script（スプレッドシート専用）が得意なこと:
  ✓ スプレッドシートの操作
  ✓ 見やすい表の作成
  ✓ リンクの生成
  ✗ 大量データ処理は遅い
```

**例え話:**
```
Python = 工場
  原材料（YouTubeのデータ）を加工して、
  半製品（CSV）を作る

Google Apps Script = 小売店
  半製品を受け取って、
  商品（見やすい表）として陳列する
```

---

### Q2: なぜCSVファイルを経由するの？

**A: データの**バックアップ**と**汎用性**のため**

```
利点1: 他のソフトでも使える
  CSV → Excel, Numbers, LibreOfficeで開ける

利点2: バックアップになる
  スプレッドシートが壊れても、CSVがあれば復元できる

利点3: デバッグしやすい
  何か問題があったとき、CSVをテキストエディタで見て確認できる
```

---

## 🧩 具体例で理解する

### 実際のデータの流れ

```
▼ YouTube動画
  タイトル: 【#歌枠】今日も歌うよ～
  説明文: セトリ↓
  コメント: "6:53 サイハテ/小林オニキス feat. 初音ミク"

       ↓ Pythonスクレイパー

▼ CSV（中間ファイル）
  No,曲,歌手-ユニット,検索用,ジャンル,タイムスタンプ,配信日,動画ID,確度スコア
  1,サイハテ,小林オニキス feat. 初音ミク,さいはて,Vocaloid,6:53,2025/02/04,abc123,0.90

       ↓ Googleスプレッドシートにコピペ

▼ リスト(一覧)シート
  ┌───┬─────────┬──────────────┬────┬─────┬─────┐
  │No │曲        │歌手-ユニット  │... │TS   │動画ID│
  ├───┼─────────┼──────────────┼────┼─────┼─────┤
  │ 1 │サイハテ   │小林オニキス...│... │6:53 │abc123│
  └───┴─────────┴──────────────┴────┴─────┴─────┘

       ↓ Google Apps Script実行

▼ 🦉リスト(Vocaloid)シート
  ┌────┬─────────┬──────────────┬──────────┬─────────────┐
  │回数│曲        │アーティスト   │配信日1   │TS1(リンク)  │
  ├────┼─────────┼──────────────┼──────────┼─────────────┤
  │ 3  │サイハテ   │小林オニキス...│2025/02/04│🔗 6:53      │
  └────┴─────────┴──────────────┴──────────┴─────────────┘
                                               ↑ クリックで動画へ
```

---

## 💡 よくある疑問

### Q: なぜ確度スコアが必要？

**A: 100%正確に判定するのは不可能だから**

```
難しい例:
  タイトル: "まったり配信"  ← 「歌」って書いてない
  説明文: （特になし）
  コメント: "かわいい" "声好き" ...

  → でもたまに歌ってる

システム:
  "うーん、60%くらい歌配信かな？"
  確度スコア: 0.60

あなた:
  後で「0.7以上だけ見る」とか調整できる
```

---

### Q: なぜ古い順に並べるの？

**A: 時系列で見たい人が多いから**

```
使用例:
  「初期の頃はどんな曲歌ってたんだろう？」
  「最近歌う曲の傾向は？」

並び順:
  2025/02/04 の配信 → 最初
  2025/09/24 の配信 → 最後

  → 歌唱スタイルの変化が分かる
```

---

### Q: なぜジャンル自動判定？

**A: 手作業で分類するのが大変だから**

```
210曲全部を手作業で分類 → 1時間かかる
自動判定 → 数秒で完了

判定ルール（シンプル）:
  "初音ミク" が含まれる → Vocaloid
  "涼宮ハルヒ" が含まれる → アニメ
  それ以外 → その他
```

---

## 🎯 システムの強みと弱み

### 強み
```
✅ 完全自動
  → 一度設定すれば、ボタン1つで動く

✅ 見逃しが少ない
  → タイトルに「歌枠」がなくても検出

✅ 重複を自動統合
  → 同じ曲が何個も出ない

✅ リンク付き
  → クリック1つで動画に飛べる
```

### 弱み
```
❌ 初回セットアップが必要
  → APIキー取得、Pythonインストールなど

❌ 完璧ではない
  → たまに歌配信じゃないのを拾う
  → たまに歌配信を見逃す

❌ APIの制限
  → 1日10,000回まで（大量チャンネルは厳しい）
```

---

## 📚 まとめ

### このシステムの本質

```
人間がやると:
  1. 動画を1つずつ開く
  2. コメント欄をスクロール
  3. タイムスタンプをメモ
  4. スプレッドシートに手入力
  → 数時間かかる

システムがやると:
  1. YouTubeに「全部の情報ちょうだい」
  2. 必要な情報だけ抽出
  3. 整理して保存
  4. 見やすく表示
  → 数分で完了
```

### 重要な5つの仕組み

1. **YouTube API** - YouTubeから情報を取り出す窓口
2. **点数制判定** - 色々な手がかりを見て歌配信かどうか判断
3. **パターン認識** - タイムスタンプの形を見つける
4. **重複統合** - 同じ曲を1つにまとめる
5. **自動整理** - ジャンル別・回数別に分類

### 得られるもの

```
Before:
  "あの曲どこで歌ってたっけ？"
  → 2時間の動画を探し回る

After:
  "あの曲どこで歌ってたっけ？"
  → スプレッドシートで検索
  → リンククリック
  → 該当箇所から再生開始！
```

---

**このシステムは、「面倒な作業を自動化する」という**
**プログラミングの本質**を体現しています。**

プログラミング未経験でも、仕組みが少し分かると
「なるほど！こうやって便利にしてるんだ！」
と納得できますね 😊
