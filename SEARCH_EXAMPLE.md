# 文字列検索ツール - 使用例

## 基本的な使い方

### 例1: 特定の曲名を探す

あるチャンネルで「夜に駆ける」が歌われた動画とタイミングを探したい場合:

```bash
python search_text.py
```

入力内容:
```
チャンネルIDを入力してください:
> UCxxxxxxxxxxxxxxxxxxxxxx

検索する文字列を入力してください:
> 夜に駆ける

検索対象を選択してください:
1. コメント
2. 字幕
3. コメント + 字幕 (推奨)
4. すべて (コメント + 字幕 + ライブチャット)
> 3

検索する動画数を入力してください:
> 50
```

出力:
- `output/csv/search_results_YYYYMMDD_HHMMSS.csv` に結果が保存される
- コメントや字幕に「夜に駆ける」が含まれているすべての箇所がリストアップされる

---

### 例2: 特定の用語が言及された箇所を探す

「マリカ」や「マリオカート」について話している部分を探す:

```bash
python search_text.py UCxxxxxx "マリカ" --all --max-videos 100
```

- 100本の動画を検索
- コメントと字幕の両方から検索
- 「マリカ」という単語が出現したすべての箇所を抽出

---

### 例3: コメントのみから検索

コメント欄にタイムスタンプ付きで書かれた特定の曲を探す:

```bash
python search_text.py UCxxxxxx "ヒバナ" --comments --max-videos 50
```

- コメントのみを検索対象とする
- 字幕は検索しない（高速）

---

### 例4: 字幕のみから検索

配信者が実際に口にした言葉から検索:

```bash
python search_text.py UCxxxxxx "次はリクエスト" --transcripts --max-videos 30
```

- 字幕（自動生成含む）のみを検索
- 配信者が「次はリクエスト」と言った箇所をすべて抽出

---

## 実用的なシナリオ

### シナリオ1: 過去の歌枠から特定の曲を全て抽出

**目的**: あるVTuberの過去の歌枠から、特定アーティストの曲が歌われた動画を全て見つけたい

**方法**:
```bash
python search_text.py UCxxxxxx "YOASOBI" --all --max-videos 200
```

**結果**:
- 過去200本の動画から「YOASOBI」が含まれるコメント・字幕を全検索
- 「夜に駆ける」「怪物」「群青」など、YOASOBIの曲が歌われたすべての動画とタイムスタンプが得られる

---

### シナリオ2: 特定のゲーム実況回を探す

**目的**: あるゲーム実況者の過去動画から「エルデンリング」の実況回を全て見つけたい

**方法**:
```bash
python search_text.py UCxxxxxx "エルデンリング" --transcripts --max-videos 100
```

**結果**:
- 字幕から「エルデンリング」が言及された動画を抽出
- どの時点でゲーム名が言及されたかもわかる

---

### シナリオ3: リスナーのリクエスト箇所を全て抽出

**目的**: コメント欄でリスナーがリクエストした曲の箇所を抽出

**方法**:
```bash
python search_text.py UCxxxxxx "リクエスト" --comments --max-videos 50
```

**結果**:
- コメント欄で「リクエスト」という単語が使われた箇所を全抽出
- どの動画のどのタイミングでリクエストがあったかがわかる

---

## 出力の見方

### CSVファイルの例

```csv
No,動画タイトル,動画ID,公開日,検索元,タイムスタンプ,検索文字列,コンテキスト,動画URL
1,【歌枠】リクエスト歌います！,abc123,2025/01/15,コメント,5:42,夜に駆ける,「5:42 夜に駆ける / YOASOBI」,https://youtube.com/watch?v=abc123&t=342
2,【ライブ配信】歌います,def456,2025/02/20,字幕,12:30,夜に駆ける,次は夜に駆けるを歌います,https://youtube.com/watch?v=def456&t=750
```

### 統計情報の例

```
======================================================================
[*] 検索結果統計
======================================================================

検索元別:
   コメント: 25件
   字幕: 12件

動画別ヒット数 (上位5件):
   【歌枠】リクエスト歌います！ (8件)
   【ライブ配信】歌います (5件)
   カラオケ配信 2025/01/20 (4件)
======================================================================
```

---

## ヒント

### より良い検索結果を得るために

1. **検索文字列は短く具体的に**
   - ❌ 「YOASOBIの夜に駆けるという曲」
   - ✅ 「夜に駆ける」

2. **コメントと字幕の両方を検索**
   - コメント: タイムスタンプ付きの曲名リストが多い
   - 字幕: 配信者が実際に言及した内容

3. **検索動画数は適切に**
   - 50本: 通常の検索に最適（約5-10分）
   - 100本: より網羅的に検索（約10-20分）
   - 200本以上: API制限に注意

4. **大文字小文字は気にしない**
   - 「yoasobi」でも「YOASOBI」でもヒットします

5. **複数回実行して絞り込む**
   - まずは50本で試す
   - 結果が少なければ100本に増やす

---

## トラブルシューティング

### Q: 検索結果が0件です

**原因1**: 検索文字列が間違っている
- 確認: スペルミスがないか、別の表記がないか

**原因2**: 検索対象が不適切
- 解決: コメントのみでなく、字幕も含めて検索

**原因3**: 検索動画数が少ない
- 解決: 50本→100本に増やす

### Q: 検索に時間がかかりすぎる

**原因**: 動画数が多すぎる、またはコメント数が多い
- 解決: 検索動画数を減らす（例: 200本→50本）
- または: コメントを除外して字幕のみ検索

### Q: API制限エラーが出る

**原因**: YouTube Data API v3の1日の制限に達した
- 解決: 翌日まで待つ、または検索動画数を減らす

---

## まとめ

このツールを使えば:

- ✅ チャンネル内で特定の曲が歌われた動画を全て見つけられる
- ✅ 特定の話題について言及された動画と箇所を抽出できる
- ✅ コメント欄のタイムスタンプ付き情報を一括取得できる
- ✅ 字幕から配信者の発言内容を検索できる

詳細な使い方は [TEXT_SEARCH_GUIDE.md](docs/TEXT_SEARCH_GUIDE.md) を参照してください。
