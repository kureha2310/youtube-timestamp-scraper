# MDファイルをGoogle Workspace に変換するGAS - 使い方ガイド

## 📋 2つのオプション

### オプション1: スプレッドシート版（おすすめ）
各mdファイルを別シートとして配置。目次から各シートにジャンプできる。

### オプション2: Googleドキュメント版
各mdファイルを個別のGoogleドキュメントとして作成。

---

## 🔷 オプション1: スプレッドシート版の使い方

### ステップ1: 準備
1. 新しいGoogleスプレッドシートを作成
2. 「拡張機能」→「Apps Script」をクリック
3. `gas-md-to-spreadsheet.js` の内容を全てコピーして貼り付け
4. 保存（Ctrl+S）

### ステップ2: シート構造を作成
1. 関数選択で `createSheetsFromMarkdown` を選択
2. 実行ボタン（▶️）をクリック
3. 初回実行時は権限を許可
4. 「目次」シートと各ドキュメント用のシートが自動作成される

### ステップ3: mdファイルの内容を貼り付け
各シートに対応するmdファイルの内容をコピペ:

1. **READMEシート**
   - `README.md` の内容を全選択してコピー
   - スプレッドシートの「README」シートのA1セルに貼り付け

2. **システム解説シート**
   - `README_システム解説.md` の内容をコピー
   - 「システム解説」シートのA1セルに貼り付け

3. **初心者向け解説シート**
   - `README_初心者向け解説.md` の内容をコピー
   - 「初心者向け解説」シートのA1セルに貼り付け

4. **仕組み解説シート**
   - `README_仕組み解説.md` の内容をコピー
   - 「仕組み解説」シートのA1セルに貼り付け

### ステップ4: フォーマットを適用
1. Apps Scriptエディタに戻る
2. 関数選択で `formatAllSheets` を選択
3. 実行ボタン（▶️）をクリック
4. 完了！見出しやコードブロックに自動で色とフォーマットが適用される

### ステップ5: 目次を確認
「目次」シートに戻ると、各ドキュメントへのリンクが作成されている

---

## 🔷 オプション2: Googleドキュメント版の使い方

### 方法A: Google Driveからインポート（推奨）

#### ステップ1: mdファイルをGoogle Driveにアップロード
1. Google Driveを開く
2. 新しいフォルダを作成（例: "YouTube Timestamp Docs"）
3. 4つのmdファイルをそのフォルダにアップロード

#### ステップ2: GASをセットアップ
1. 新しいGoogleドキュメントを作成（何でもOK、後で削除可能）
2. 「拡張機能」→「Apps Script」をクリック
3. `gas-md-to-docs.js` の内容を全てコピーして貼り付け
4. 保存（Ctrl+S）

#### ステップ3: 一括変換を実行
1. 関数選択で `convertMultipleMarkdownFiles` を選択
2. 実行ボタン（▶️）をクリック
3. フォルダIDを入力:
   - Google DriveでmdファイルをアップロードしたフォルダのURLを開く
   - URLの最後の部分がフォルダID
   - 例: `https://drive.google.com/drive/folders/FOLDER_ID_HERE`
4. 完了！4つのGoogleドキュメントが自動作成される

### 方法B: 1ファイルずつ変換

#### ステップ1〜2: 上記と同じ

#### ステップ3: ファイルIDを取得
1. Google Driveでmdファイルを右クリック→「リンクを取得」
2. URLからファイルIDをコピー
   - 例: `https://drive.google.com/file/d/FILE_ID_HERE/view`

#### ステップ4: 変換を実行
1. 関数選択で `convertMarkdownToGoogleDocs` を選択
2. 実行ボタン（▶️）をクリック
3. ファイルIDを入力
4. 新しいGoogleドキュメントが作成される
5. 他のmdファイルも同様に繰り返す

---

## 🎨 変換後の見た目

### スプレッドシート版
```
目次シート:
┌──────────────────────────────────────┐
│ 📚 YouTube歌配信タイムスタンプ管理... │
│                                      │
│ → README - 概要                      │ ← クリックでジャンプ
│ → システム解説                       │
│ → 初心者向け解説                     │
│ → 仕組み解説                         │
└──────────────────────────────────────┘

各シート:
- 見出し1: 青背景、白文字、18pt
- 見出し2: 薄青背景、14pt
- 見出し3: 灰色背景、12pt
- コードブロック: Courier New、灰色背景
```

### Googleドキュメント版
```
- 見出し1〜5が自動適用
- コードブロックはCourier Newフォント
- リスト項目は自動認識
- リンクはクリック可能なハイパーリンク
```

---

## 💡 Tips

### スプレッドシート版の利点
- ✅ 全ドキュメントが1つのファイルに
- ✅ 目次から素早くアクセス
- ✅ シート間の移動が簡単
- ✅ 検索機能（Ctrl+F）が全シート対象

### Googleドキュメント版の利点
- ✅ より自然な読み心地
- ✅ コメント機能が使える
- ✅ 印刷に最適
- ✅ 共同編集しやすい

---

## 🔧 カスタマイズ

### 色を変更したい場合（スプレッドシート版）

`formatMarkdownSheet` 関数内の以下の部分を編集:

```javascript
// 見出し1の背景色
cell.setBackground('#4285f4'); // ← この色コードを変更

// 見出し2の背景色
cell.setBackground('#e8f0fe'); // ← この色コードを変更
```

### 新しいmdファイルを追加したい場合

`createSheetsFromMarkdown` 関数内の配列に追加:

```javascript
const mdFiles = [
  { name: 'README', title: 'README - 概要' },
  { name: 'システム解説', title: 'システム解説' },
  { name: '初心者向け解説', title: '初心者向け解説' },
  { name: '仕組み解説', title: '仕組み解説' },
  { name: '新しいファイル', title: '新しいファイルのタイトル' } // ← 追加
];
```

---

## ❓ トラブルシューティング

### Q: 権限エラーが出る
**A:** 初回実行時は以下の手順で許可が必要:
1. 「権限を確認」をクリック
2. Googleアカウントを選択
3. 「詳細」→「安全ではないページに移動」
4. 「許可」をクリック

### Q: フォーマットが適用されない
**A:** 以下を確認:
- mdファイルの内容をA1セルから貼り付けているか
- `formatAllSheets()` を実行したか
- 貼り付け時に「書式なしで貼り付け」を選択したか（Ctrl+Shift+V）

### Q: リンクがクリックできない
**A:** Google Driveの共有設定を確認:
- mdファイルのリンク先URLが正しいか
- リンク先のファイルが共有されているか

### Q: 日本語が文字化けする
**A:** mdファイルの文字コードをUTF-8に変更:
1. テキストエディタでmdファイルを開く
2. 「UTF-8で保存」を選択
3. 再度Google Driveにアップロード

---

## 📚 応用例

### 定期的に更新する場合
1. mdファイルを更新
2. スプレッドシート版: 該当シートのデータを削除して再度貼り付け→`formatAllSheets()`実行
3. ドキュメント版: 再度`convertMarkdownToGoogleDocs()`を実行

### 他の人と共有する場合
- スプレッドシート/ドキュメントの共有設定で「リンクを知っている全員」に設定
- 「閲覧者」権限を付与（編集させたくない場合）

---

**これで、mdファイルを簡単にGoogleドキュメント/スプレッドシートで管理できます！**
